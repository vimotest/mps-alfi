/*
  Gradle tasks to run the compitest scripts
  Requires python 3.10 and python-poetry to be installed
 */

task compitestRunTests {
    group 'compitest'
    description 'Run the ALF-reference runtime comparison tests'
    doLast {
        def workingDir = file("$projectDir/scripts/alfCompareTest")
        def scriptFile = file("$workingDir/CompareTestMain.groovy")

        def binding = new Binding([workingDir: workingDir])
        def shell = new GroovyShell(binding)
        shell.getClassLoader().addURL(workingDir.toURI().toURL())
        shell.evaluate(scriptFile)
    }
}

task compitestClean(type: Delete) {
  group 'compitest'
  delete file("build/compitest")
}
